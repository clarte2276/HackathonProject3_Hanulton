{"ast":null,"code":"import React,{useState,useEffect}from'react';import'./Chatlist.css';import{Link,useNavigate}from'react-router-dom';import axios from'axios';import BasicNavbar from'../Navbar/BasicNavbar';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Chatlist=()=>{const[dataList,setDataList]=useState([]);const[currentPage,setCurrentPage]=useState(1);const postsPerPage=5;const navigate=useNavigate();useEffect(()=>{axios.get('/process/check-login',{withCredentials:true}).then(response=>{if(!response.data.loggedIn){navigate('/loginpage');}else{fetchChatList();}}).catch(error=>{console.error('Error checking login status:',error);});},[]);const fetchChatList=()=>{axios.post('/chat/list',{},{withCredentials:true}).then(response=>{setDataList(response.data);}).catch(error=>{console.error('There was an error fetching the chat list!',error);});};const indexOfLastPost=currentPage*postsPerPage;const indexOfFirstPost=indexOfLastPost-postsPerPage;const currentPosts=Array.isArray(dataList)?dataList.slice(indexOfFirstPost,indexOfLastPost):[];const handleChatItemClick=userId=>{window.parent.postMessage({userId},'*');};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(BasicNavbar,{title:\"\\uCC44\\uD305\"}),/*#__PURE__*/_jsx(\"ul\",{children:currentPosts.map(item=>/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"img_name\",children:/*#__PURE__*/_jsx(Link,{className:\"chat-item\",onClick:()=>handleChatItemClick(item.id),children:/*#__PURE__*/_jsx(\"span\",{className:\"user_nickname\",children:item.nickname})})})},item.id))}),/*#__PURE__*/_jsx(\"div\",{className:\"pagination\",children:Array.from({length:Math.ceil(dataList.length/postsPerPage)},(_,i)=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentPage(i+1),className:currentPage===i+1?'active':'',children:i+1},i+1))})]});};export default Chatlist;","map":{"version":3,"names":["React","useState","useEffect","Link","useNavigate","axios","BasicNavbar","jsx","_jsx","jsxs","_jsxs","Chatlist","dataList","setDataList","currentPage","setCurrentPage","postsPerPage","navigate","get","withCredentials","then","response","data","loggedIn","fetchChatList","catch","error","console","post","indexOfLastPost","indexOfFirstPost","currentPosts","Array","isArray","slice","handleChatItemClick","userId","window","parent","postMessage","children","title","map","item","className","onClick","id","nickname","from","length","Math","ceil","_","i"],"sources":["C:/Users/atwod/OneDrive/바탕 화면/동국대 폴더/백엔드 공부/HackathonProject3_Hanulton/front-end/src/components/chat/Chatlist.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport './Chatlist.css';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport BasicNavbar from '../Navbar/BasicNavbar';\r\n\r\nconst Chatlist = () => {\r\n  const [dataList, setDataList] = useState([]);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const postsPerPage = 5;\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    axios\r\n      .get('/process/check-login', { withCredentials: true })\r\n      .then((response) => {\r\n        if (!response.data.loggedIn) {\r\n          navigate('/loginpage');\r\n        } else {\r\n          fetchChatList();\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        console.error('Error checking login status:', error);\r\n      });\r\n  }, []);\r\n\r\n  const fetchChatList = () => {\r\n    axios\r\n      .post('/chat/list', {}, { withCredentials: true })\r\n      .then((response) => {\r\n        setDataList(response.data);\r\n      })\r\n      .catch((error) => {\r\n        console.error('There was an error fetching the chat list!', error);\r\n      });\r\n  };\r\n\r\n  const indexOfLastPost = currentPage * postsPerPage;\r\n  const indexOfFirstPost = indexOfLastPost - postsPerPage;\r\n  const currentPosts = Array.isArray(dataList) ? dataList.slice(indexOfFirstPost, indexOfLastPost) : [];\r\n\r\n  const handleChatItemClick = (userId) => {\r\n    window.parent.postMessage({ userId }, '*');\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <BasicNavbar title=\"채팅\" />\r\n      <ul>\r\n        {currentPosts.map((item) => (\r\n          <li key={item.id}>\r\n            <div className=\"img_name\">\r\n              <Link className=\"chat-item\" onClick={() => handleChatItemClick(item.id)}>\r\n                <span className=\"user_nickname\">{item.nickname}</span>\r\n              </Link>\r\n            </div>\r\n          </li>\r\n        ))}\r\n      </ul>\r\n      <div className=\"pagination\">\r\n        {Array.from({ length: Math.ceil(dataList.length / postsPerPage) }, (_, i) => (\r\n          <button key={i + 1} onClick={() => setCurrentPage(i + 1)} className={currentPage === i + 1 ? 'active' : ''}>\r\n            {i + 1}\r\n          </button>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Chatlist;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}